# Вычислительный эксперимент

__Тема:__ \
Оптимизация прерываемых расписаний на одной машине, минимизирующих суммарное взвешенное время ранних и поздних времен начал и завершений всех работ

---------

Программная реализация алгоритмов, модели, данные и ноутбук для проведения вычислительного эксперимента.

## Ноутбуки

jupyter notebook `tests.ipynb`

- генерация задач
- решение задач, сохранение результатов в файлы
- прочие вспомогательные функции

jupyter notebook `stats.ipynb`

- подсчет статистики по результатам: таблицы

## Данные

`data.zip` -- результаты, сгенерированные задачи, их решения.

Для подсчета статистики в ноутбуке, необходимо распаковать `data.zip` в директорию `./data`

__JSON__

Одна задача -- один файл. Файл содержит одновременно параметры задачи и её решения.

`./data/json` \
`./data/json/n3p3` -- задачи с параметрами n=3, p=3  \
`./data/json/n3p5` -- задачи с параметрами n=3, p=5  \
и т.д.

К примеру `./data/json/n3p3/002d4ba451e5d59298587a1ffd9b653f.json`

Структура JSON файла
```javascript
{
	// Уникальный идентификатор задачи (hash-функция от параметров задачи)
	"id": "002d4ba451e5d59298587a1ffd9b653f",
	
	// Характеристики работ (параметры задачи)
	"params": {
		"p" : [3, 3, 3],  // Количество операций
		"w" : [2, 22, 9], // Коэффициент приоритетности
		"d1": [7, 6, 4],  // Раннее время завершения
		"d2": [7, 9, 6],  // Позднее время завершения
		"s1": [4, 5, 1],  // Ранее начало работ
		"s2": [6, 5, 1],  // Позднее начало работ
		"r" : [3, 2, 1]   // Время доступности
	},
	
	// Результаты
	"results": {
	
		// Результаты оптимального решения задачи ЦЛП (для сверки)
		"osp_blp": {
			// Решатель
			"solver": "highs",
			
			// Время выполнения (секунды)
			"exec_time": 0.564000129699707,
			
			// Значение целевой функции
			"obj": 2,
			
			// Решение. i = строка, x[i] = столбец
			"x": [2,3,6,4,7,8,0,1,5]
		},
		
		// Результаты оптимального решения АВиГ:
		// ветвление по первой доступной дуге (1A)
		"osp_lap_bnb_1st_arc": {
			// Решатель ЗР. АВиГ
			"bnb_solver": "solve_osp_lap_bnb_2d_v4_0",
			
			// Решатель ЗН
			"lap_solver": "lapjv",
			
			// Значение целевой функции
			"obj": 2,
			
			// Количество вершин в ДПОР
			"n_tree_nodes": 9,
			
			// Количество решенных ЗН
			"n_lap_solved": 5,

			// Количество созданных ЗН
			"n_created_w": 8,
			
			// Количество ветвлений
			"n_branching": 4,
			
			// Причина остановки алгоритма
			// stop_reason = "" -- найдено оптимальное решение
			// stop_reason = "t_stop_time" -- превышено время выполнения (90 минут)
			"stop_reason": "",
			
			// Время выполнения (секунды)
			"exec_time": 0,
			
			// Решение. i = строка, x[i] = столбец
			"x": [2,3,6,4,7,8,0,1,5]
		},
		
		// Результаты оптимального решения АВиГ:
		// ветвление по дуге с наибольшей стоимостью (HCA)
		"osp_lap_bnb_hc_arc": {
			...
		},
		
		// Результаты оптимального решения АВиГ:
		// ветвление по дуге с наименьшей стоимостью (LCA)
		"osp_lap_bnb_lc_arc": {
			...
		},
		
		// Результаты оптимального решения АВиГ:
		// ветвление по дуге с наименьшей стоимостью;
		// нижняя оценка усилена верхним допуском (LCAUT)
		"osp_lap_bnb_lc_arc_utol": {
			...
		},
		
		// Результаты оптимального решения АВиГ:
		// ветвление по дуге с наименьшим верхним допуском (LUT)
		"osp_lap_bnb_lo_utol": {
			...
		},
		
		// WSRPT эвристика 
		"wsrpt": {
			// Время выполнения (секунды)
			"exec_time": 0,
			
			// Значение целевой функции
			"obj": 116,
			
			// Расписание
			"s": [3,2,2,2,3,3,1,1,1],
		},
		
		// Решение ЛП
		"lp": {
			// Решатель
			"solver": "highs",
			
			// Время выполнения (секунды)
			"exec_time": 0.5569980144500732,

			// Значение целевой функции
			"obj": 0.8000004,
			
			// Решение ЛП в формате [[j, k, t], value]
			"x": [
				[[0,0,2],0.4000002],
				[[0,0,5],0.5999998],
				[[0,1,3],0.1000003],
				[[0,1,5],0.2999999],
				[[0,1,7],0.5999998],
				[[0,2,6],1],
				[[1,0,4],1],
				[[1,1,2],0.5999998],
				[[1,1,7],0.4000002],
				[[1,2,8],1],
				[[2,0,0],1],
				[[2,1,1],1],
				[[2,2,3],0.8999997],
				[[2,2,5],0.1000003]
			]
		},
		
		// Эвристика А1
		"a1": {
			// Время выполнения (секунды)
			"exec_time": 0,
			
			// Значение целевой функции
			"obj": 55,
			
			// Расписание
			"s": [3,3,3,1,1,1,2,2,2]
		},
		
		// Эвристика А2
		"a2": {
			// Время выполнения (секунды)
			"exec_time": 0,
			
			// Значение целевой функции
			"obj": 55,
			
			// Расписание
			"s": [3,3,3,1,1,1,2,2,2],
		}
	}
}
```

## Модель ЦЛП (для сверки)
Модели для решателя написаны на языке minizinc и запускаются из среды minizinc. В качестве решателя для ЛП и ЦЛП используется HiGHS (https://highs.dev)

`model_blp.mzn` -- модель целочисленного (двоичного) линейного программирования для решения задачи составления оптимального расписания с целью минимизировать общие штрафы, накладываемые на работы. (Параметры и целевая функция заявлены в теме)

`model_lp.mzn` -- релаксированная модель первичной задачи из `model_blp.mzn`, модель линейного программирования без целочисленных переменных.