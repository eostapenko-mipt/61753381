# Вычислительный эксперимент

__Тема:__ \
Оптимизация прерываемых расписаний на одной машине, минимизирующих суммарное взвешенное время ранних и поздних времен начал и завершений всех работ

---------

Модели, данные и ноутбук для проведения вычислительного эксперимента.

## Ноутбуки

jupyter notebook `tests.ipynb`

- генерация задач
- решение задач, сохранение результатов в файлы
- прочие вспомогательные функции

jupyter notebook `stats.ipynb`

- подсчет статистики по результатам: таблицы

## Данные

`data.zip` -- результаты, сгенерированные задачи, их решения.

Для подсчета статистики в ноутбуке, необходимо распаковать `data.zip` в директорию `./data`

__JSON__

Одна задача -- один файл. Файл содержит одновременно параметры задачи и её решения.

`./data/json` \
`./data/json/n3p3` -- задачи с параметрами n=3, p=3  \
`./data/json/n3p5` -- задачи с параметрами n=3, p=5  \
и т.д.

К примеру `./data/json/n3p2/99a37c0a6ad354c66228bd4224acafb8.json`

Структура JSON файла
```javascript
{
	// Уникальный идентификатор задачи (hash-функция от параметров задачи)
	"id": "99a37c0a6ad354c66228bd4224acafb8",
	
	// Характеристики работ (параметры задачи)
	"params": {
		"p" : [2, 2, 2],
		"w" : [24, 27, 18],
		"d1": [6, 4, 5],
		"d2": [6, 6, 6],
		"s1": [5, 1, 5],
		"s2": [5, 2, 5],
		"r" : [2, 1, 3]
	},

	// Результаты
	"results": {
	
		// Результаты оптимального решения задачи ЦЛП (для сверки)
		"osp_blp": {
			// Решатель
			"solver": "highs",
			
			// Время выполнения (секунды)
			"exec_time": 0.0,
			
			// Значение целевой функции
			"obj": 108,
			
			// Решение
			"x": [
				[
					[0, 1, 0, 0, 0, 0],
					[0, 0, 0, 0, 0, 1]
				], [
					[1, 0, 0, 0, 0, 0],
					[0, 0, 0, 1, 0, 0]
				], [
					[0, 0, 1, 0, 0, 0],
					[0, 0, 0, 0, 1, 0]
				]
			]
		},
		
		// Результаты оптимального решения АВиГ:
		// ветвление по первой доступной дуге (1A)
		"osp_lap_bnb_1st_arc": {
			// Решатель ЗР. АВиГ
			"bnb_solver": "solve_osp_lap_bnb_2d_v3_3",
			
			// Решатель ЗН
			"lap_solver": "scipy",

			// Значение целевой функции
			"obj": 108,
			
			// Количество вершин в ДПОР
			"n_tree_nodes": 1,
			
			// Количество решенных ЗН
			"n_lap_solved": 1,
			
			// Время выполнения (секунды)
			"exec_time": 0.0,
			
			// Решение
			"x": [
				[
					[0, 1, 0, 0, 0, 0],
					[0, 0, 0, 0, 0, 1]
				], [
					[1, 0, 0, 0, 0, 0],
					[0, 0, 0, 1, 0, 0]
				], [
					[0, 0, 1, 0, 0, 0],
					[0, 0, 0, 0, 1, 0]
				]
			]
		},
		
		// Результаты оптимального решения АВиГ:
		// ветвление по дуге с наибольшей стоимостью (HCA)
		"osp_lap_bnb_hc_arc": {
			// Решатель ЗР. АВиГ
			"bnb_solver": "solve_osp_lap_bnb_2d_v3_3",
			
			// Решатель ЗН
			"lap_solver": "scipy",

			// Значение целевой функции
			"obj": 108,
			
			// Количество вершин в ДПОР
			"n_tree_nodes": 1,
			
			// Количество решенных ЗН
			"n_lap_solved": 1,
			
			// Время выполнения (секунды)
			"exec_time": 0.0,
			
			// Решение
			"x": [
				[
					[0, 1, 0, 0, 0, 0],
					[0, 0, 0, 0, 0, 1]
				], [
					[1, 0, 0, 0, 0, 0],
					[0, 0, 0, 1, 0, 0]
				], [
					[0, 0, 1, 0, 0, 0],
					[0, 0, 0, 0, 1, 0]
				]
			]
		},
		
		// Результаты оптимального решения АВиГ:
		// ветвление по дуге с наименьшей стоимостью (LCA)
		"osp_lap_bnb_lc_arc": {
			// Решатель ЗР. АВиГ
			"bnb_solver": "solve_osp_lap_bnb_2d_v3_3",
			
			// Решатель ЗН
			"lap_solver": "scipy",
			
			// Значение целевой функции
			"obj": 108,
			
			// Количество вершин в ДПОР
			"n_tree_nodes": 1,
			
			// Количество решенных ЗН
			"n_lap_solved": 1,
			
			// Время выполнения (секунды)
			"exec_time": 0.0,
			
			// Решение
			"x": [
				[
					[0, 1, 0, 0, 0, 0],
					[0, 0, 0, 0, 0, 1]
				], [
					[1, 0, 0, 0, 0, 0],
					[0, 0, 0, 1, 0, 0]
				], [
					[0, 0, 1, 0, 0, 0],
					[0, 0, 0, 0, 1, 0]
				]
			]
		},
		
		// Результаты оптимального решения АВиГ:
		// ветвление по дуге с наименьшей стоимостью;
		// нижняя оценка усилена верхним допуском (LCAUT)
		"osp_lap_bnb_lc_arc_utol": {
			// Решатель ЗР. АВиГ
			"bnb_solver": "solve_osp_lap_bnb_2d_v3_3",
			
			// Решатель ЗН
			"lap_solver": "scipy",

			// Значение целевой функции
			"obj": 108,
			
			// Количество вершин в ДПОР
			"n_tree_nodes": 1,
			
			// Количество решенных ЗН
			"n_lap_solved": 1,
			
			// Время выполнения (секунды)
			"exec_time": 0.0,
			
			// Решение
			"x": [
				[
					[0, 1, 0, 0, 0, 0],
					[0, 0, 0, 0, 0, 1]
				], [
					[1, 0, 0, 0, 0, 0],
					[0, 0, 0, 1, 0, 0]
				], [
					[0, 0, 1, 0, 0, 0],
					[0, 0, 0, 0, 1, 0]
				]
			]
		},
		
		// Результаты оптимального решения АВиГ:
		// ветвление по дуге с наименьшим верхним допуском (LUT)
		"osp_lap_bnb_lo_utol": {
			// Решатель ЗР. АВиГ
			"bnb_solver": "solve_osp_lap_bnb_2d_v3_3",
			
			// Решатель ЗН
			"lap_solver": "scipy",
			
			// Значение целевой функции
			"obj": 108,
			
			// Количество вершин в ДПОР
			"n_tree_nodes": 1,
			
			// Количество решенных ЗН
			"n_lap_solved": 1,
			
			// Время выполнения (секунды)
			"exec_time": 0.0,
			
			// Решение
			"x": [
				[
					[0, 1, 0, 0, 0, 0],
					[0, 0, 0, 0, 0, 1]
				], [
					[1, 0, 0, 0, 0, 0],
					[0, 0, 0, 1, 0, 0]
				], [
					[0, 0, 1, 0, 0, 0],
					[0, 0, 0, 0, 1, 0]
				]
			]
		}
	}
}
```

## Модель ЦЛП (для сверки)
Модели для решателя написаны на языке minizinc и запускаются из среды minizinc. В качестве решателя для ЛП и ЦЛП используется HiGHS (https://highs.dev)

`model_blp.mzn` -- модель целочисленного (двоичного) линейного программирования для решения задачи составления оптимального расписания с целью минимизировать общие штрафы, накладываемые на работы. (Параметры и целевая функция заявлены в теме)

`model_lp.mzn` -- релаксированная модель первичной задачи из `model_blp.mzn`, модель линейного программирования без целочисленных переменных.